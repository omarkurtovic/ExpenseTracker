@using ExpenseTrackerSharedCL.Features.Categories.Dtos
@using MudBlazor
@using ExpenseTrackerWasmWebApp.Features.SharedKernel.Components

<EntityCard OnEdit="@(() => OpenCategoryDialogAsync.InvokeAsync(CategoryDto))" OnDelete="@(() => ConfirmDelete.InvokeAsync(CategoryDto?.Id ?? 0))">
    <HeaderContent>
    <TextWithIcon Text="@CategoryDto.Name" Icon="@CategoryDto.Icon" IconColor="@CategoryDto.Color" IconSize="Size.Large" TextTypo="Typo.h6"></TextWithIcon>
    </HeaderContent>
    <Content>
        <MudText Typo="Typo.body1">Total transactions: @CategoryDto.TransactionsCount</MudText>
        <MudPaper Elevation="0" Class="d-flex gap-2 mb-3">
            <MudText Typo="Typo.body1">@(CategoryDto.Type == TransactionTypeDto.Income ? "Total income: " : "Total expenses: ")</MudText>
            <AmountDisplay Amount="@CategoryDto.TotalAmount" FontSize="Typo.body1" />
        </MudPaper>
        <MudPaper Elevation="0" Class="d-flex gap-2 align-center">
            <MudText Typo="Typo.body1" Class="flex-grow-1">vs Last Month:</MudText>
            <MudText Typo="Typo.body1" Color="@CategoryDto.ComparisonColor" Class="month-comparison">
                @CategoryDto.ComparisonDisplay
            </MudText>
        </MudPaper>
    </Content>
</EntityCard>

<style>
.month-comparison {
    font-weight: 700;
    font-size: 1.1em;
}
</style>

@code{
    [Parameter]
    public required CategoryWithStatsDto CategoryDto { get; set; }

    [Parameter]
    public EventCallback<CategoryWithStatsDto?> OpenCategoryDialogAsync { get; set; }

    [Parameter]
    public EventCallback<int> ConfirmDelete { get; set; }

}